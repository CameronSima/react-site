/*istanbul ignore next*/'use strict'; /* istanbul ignore next */var __cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8 = function () {var path = '/home/cameron/Projects/react-site/src/components/Comment/CommentBox.js',hash = 'cb1706e7d21aaa39b67a4f59749c3794704202cb',global = new Function('return this')(),gcv = '__coverage__',coverageData = { path: '/home/cameron/Projects/react-site/src/components/Comment/CommentBox.js', statementMap: { '1': { start: { line: 3, column: 188 }, end: { line: 3, column: 242 } }, '2': { start: { line: 5, column: 13 }, end: { line: 5, column: 39 } }, '3': { start: { line: 7, column: 8 }, end: { line: 7, column: 25 } }, '4': { start: { line: 10, column: 41 }, end: { line: 87, column: 6 } }, '5': { start: { line: 14, column: 15 }, end: { line: 14, column: 19 } }, '6': { start: { line: 15, column: 4 }, end: { line: 15, column: 53 } }, '7': { start: { line: 16, column: 4 }, end: { line: 16, column: 65 } }, '8': { start: { line: 18, column: 18 }, end: { line: 20, column: 6 } }, '9': { start: { line: 19, column: 6 }, end: { line: 19, column: 40 } }, '10': { start: { line: 22, column: 4 }, end: { line: 31, column: 5 } }, '11': { start: { line: 23, column: 6 }, end: { line: 27, column: 7 } }, '12': { start: { line: 24, column: 8 }, end: { line: 24, column: 23 } }, '13': { start: { line: 26, column: 8 }, end: { line: 26, column: 36 } }, '14': { start: { line: 28, column: 6 }, end: { line: 30, column: 9 } }, '15': { start: { line: 29, column: 8 }, end: { line: 29, column: 37 } }, '16': { start: { line: 32, column: 4 }, end: { line: 32, column: 16 } }, '17': { start: { line: 36, column: 19 }, end: { line: 36, column: 38 } }, '18': { start: { line: 37, column: 22 }, end: { line: 37, column: 48 } }, '19': { start: { line: 38, column: 4 }, end: { line: 38, column: 41 } }, '20': { start: { line: 39, column: 4 }, end: { line: 52, column: 22 } }, '21': { start: { line: 46, column: 8 }, end: { line: 46, column: 38 } }, '22': { start: { line: 51, column: 8 }, end: { line: 51, column: 62 } }, '23': { start: { line: 56, column: 4 }, end: { line: 56, column: 24 } }, '24': { start: { line: 59, column: 4 }, end: { line: 59, column: 46 } }, '25': { start: { line: 60, column: 18 }, end: { line: 67, column: 25 } }, '26': { start: { line: 75, column: 27 }, end: { line: 75, column: 62 } }, '27': { start: { line: 76, column: 4 }, end: { line: 84, column: 57 } }, '28': { start: { line: 90, column: 0 }, end: { line: 90, column: 28 } } }, fnMap: { '1': { name: '_interopRequireDefault', decl: { start: { line: 3, column: 159 }, end: { line: 3, column: 181 } }, loc: { start: { line: 3, column: 187 }, end: { line: 3, column: 243 } } }, '2': { name: 'buildTree', decl: { start: { line: 13, column: 46 }, end: { line: 13, column: 55 } }, loc: { start: { line: 13, column: 77 }, end: { line: 33, column: 3 } } }, '3': { name: '(anonymous_3)', decl: { start: { line: 18, column: 34 }, end: { line: 18, column: 35 } }, loc: { start: { line: 18, column: 51 }, end: { line: 20, column: 5 } } }, '4': { name: '(anonymous_4)', decl: { start: { line: 28, column: 22 }, end: { line: 28, column: 23 } }, loc: { start: { line: 28, column: 39 }, end: { line: 30, column: 7 } } }, '5': { name: 'handleCommentSubmit', decl: { start: { line: 35, column: 56 }, end: { line: 35, column: 75 } }, loc: { start: { line: 35, column: 85 }, end: { line: 54, column: 3 } } }, '6': { name: '(anonymous_6)', decl: { start: { line: 45, column: 15 }, end: { line: 45, column: 16 } }, loc: { start: { line: 45, column: 31 }, end: { line: 48, column: 7 } } }, '7': { name: '(anonymous_7)', decl: { start: { line: 49, column: 13 }, end: { line: 49, column: 14 } }, loc: { start: { line: 49, column: 41 }, end: { line: 52, column: 7 } } }, '8': { name: 'getInitialState', decl: { start: { line: 55, column: 52 }, end: { line: 55, column: 67 } }, loc: { start: { line: 55, column: 70 }, end: { line: 57, column: 3 } } }, '9': { name: 'onAddFile', decl: { start: { line: 58, column: 46 }, end: { line: 58, column: 55 } }, loc: { start: { line: 58, column: 61 }, end: { line: 70, column: 3 } } }, '10': { name: 'render', decl: { start: { line: 72, column: 43 }, end: { line: 72, column: 49 } }, loc: { start: { line: 72, column: 52 }, end: { line: 87, column: 3 } } } }, branchMap: { '1': { loc: { start: { line: 3, column: 195 }, end: { line: 3, column: 241 } }, type: 'cond-expr', locations: [{ start: { line: 3, column: 219 }, end: { line: 3, column: 222 } }, { start: { line: 3, column: 225 }, end: { line: 3, column: 241 } }] }, '2': { loc: { start: { line: 3, column: 195 }, end: { line: 3, column: 216 } }, type: 'binary-expr', locations: [{ start: { line: 3, column: 195 }, end: { line: 3, column: 198 } }, { start: { line: 3, column: 202 }, end: { line: 3, column: 216 } }] }, '3': { loc: { start: { line: 15, column: 11 }, end: { line: 15, column: 52 } }, type: 'cond-expr', locations: [{ start: { line: 15, column: 43 }, end: { line: 15, column: 47 } }, { start: { line: 15, column: 50 }, end: { line: 15, column: 52 } }] }, '4': { loc: { start: { line: 16, column: 13 }, end: { line: 16, column: 64 } }, type: 'cond-expr', locations: [{ start: { line: 16, column: 45 }, end: { line: 16, column: 51 } }, { start: { line: 16, column: 54 }, end: { line: 16, column: 64 } }] }, '5': { loc: { start: { line: 22, column: 4 }, end: { line: 31, column: 5 } }, type: 'if', locations: [{ start: { line: 22, column: 4 }, end: { line: 31, column: 5 } }, { start: { line: 22, column: 4 }, end: { line: 31, column: 5 } }] }, '6': { loc: { start: { line: 23, column: 6 }, end: { line: 27, column: 7 } }, type: 'if', locations: [{ start: { line: 23, column: 6 }, end: { line: 27, column: 7 } }, { start: { line: 23, column: 6 }, end: { line: 27, column: 7 } }] } }, s: { '1': 0, '2': 0, '3': 0, '4': 0, '5': 0, '6': 0, '7': 0, '8': 0, '9': 0, '10': 0, '11': 0, '12': 0, '13': 0, '14': 0, '15': 0, '16': 0, '17': 0, '18': 0, '19': 0, '20': 0, '21': 0, '22': 0, '23': 0, '24': 0, '25': 0, '26': 0, '27': 0, '28': 0 }, f: { '1': 0, '2': 0, '3': 0, '4': 0, '5': 0, '6': 0, '7': 0, '8': 0, '9': 0, '10': 0 }, b: { '1': [0, 0], '2': [0, 0], '3': [0, 0], '4': [0, 0], '5': [0, 0], '6': [0, 0] } },coverage = global[gcv] || (global[gcv] = {});if (coverage[path] && coverage[path].hash === hash) {return coverage[path];}coverageData.hash = hash;return coverage[path] = coverageData;}();var /*istanbul ignore next*/_react = require('react'); /*istanbul ignore next*/var _react2 = _interopRequireDefault(_react);
var /*istanbul ignore next*/_CommentList = require('./CommentList'); /*istanbul ignore next*/var _CommentList2 = _interopRequireDefault(_CommentList);
var /*istanbul ignore next*/_CommentForm = require('./CommentForm'); /*istanbul ignore next*/var _CommentForm2 = _interopRequireDefault(_CommentForm);function _interopRequireDefault(obj) {/* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.f['1'];++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['1'];return (/* istanbul ignore next */(++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.b['2'][0], obj) && /* istanbul ignore next */(++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.b['2'][1], obj.__esModule) ? /* istanbul ignore next */(++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.b['1'][0], obj) : /* istanbul ignore next */(++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.b['1'][1], { default: obj }));}

var config = /* istanbul ignore next */(++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['2'], require('../../../config'));

var _ = /* istanbul ignore next */(++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['3'], require('lodash'));


var CommentBox = /* istanbul ignore next */( /*istanbul ignore next*/++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['4'], _react2.default.createClass({ /*istanbul ignore next*/displayName: 'CommentBox',

  // turn flat array of comments into threaded comment array
  buildTree: function /*istanbul ignore next*/buildTree(array, parent, tree) {/* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.f['2'];
    var self = /* istanbul ignore next */(++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['5'], this); /* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['6'];
    tree = typeof parent !== 'undefined' ? /* istanbul ignore next */(++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.b['3'][0], tree) : /* istanbul ignore next */(++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.b['3'][1], []); /* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['7'];
    parent = typeof parent !== 'undefined' ? /* istanbul ignore next */(++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.b['4'][0], parent) : /* istanbul ignore next */(++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.b['4'][1], { _id: 0 });

    var replies = /* istanbul ignore next */(++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['8'], _.filter(array, function (child) {/* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.f['3'];++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['9'];
      return child.parent == parent._id;
    })); /* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['10'];

    if (!_.isEmpty(replies)) {/* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.b['5'][0];++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['11'];
      if (parent._id == '0') {/* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.b['6'][0];++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['12'];
        tree = replies;
      } else {/* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.b['6'][1];++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['13'];
        parent['replies'] = replies;
      } /* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['14'];
      _.each(replies, function (child) {/* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.f['4'];++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['15'];
        self.buildTree(array, child);
      });
    } else /* istanbul ignore next */{++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.b['5'][1];}++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['16'];
    return tree;
  },

  handleCommentSubmit: function /*istanbul ignore next*/handleCommentSubmit(comment) {/* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.f['5'];
    var comments = /* istanbul ignore next */(++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['17'], this.props.comments);
    var newComments = /* istanbul ignore next */(++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['18'], comments.concat([comment])); /* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['19'];
    this.setState({ data: newComments }); /* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['20'];
    $.ajax({
      url: config.apiUrl + 'comments/',
      dataType: 'json',
      type: 'POST',
      data: comment,
      xhrFields: { withCredentials: true },
      success: function (data) {/* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.f['6'];++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['21'];
        this.setState({ data: data });

      }.bind(this),
      error: function (xhr, status, err) {/* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.f['7'];++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['22'];

        console.error(this.props.url, status, err.toString());
      }.bind(this) });

  },
  getInitialState: function /*istanbul ignore next*/getInitialState() {/* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.f['8'];++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['23'];
    return { data: [] };
  },
  onAddFile: function /*istanbul ignore next*/onAddFile(res) {/* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.f['9'];++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['24'];
    this.setState({ imageUrl: res.imageUrl });
    var newFile = /* istanbul ignore next */(++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['25'], {
      id: res.file.name,
      name: res.file.name,
      size: res.file.size,
      altText: '',
      caption: '',
      file: res.file,
      url: res.imageUrl });

    //this.executeAction(newImageAction, newFile);
  },

  render: function /*istanbul ignore next*/render() {/* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.f['10'];
    //console.log(this.props.comments)

    var threadedComments = /* istanbul ignore next */(++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['26'], this.buildTree(this.props.comments)); /* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['27'];
    return (
      /*istanbul ignore next*/_react2.default.createElement( /*istanbul ignore next*/'div', /*istanbul ignore next*/{ className: 'commentBox' },

      /*istanbul ignore next*/_react2.default.createElement( /*istanbul ignore next*/_CommentList2.default, /*istanbul ignore next*/{ threadId: this.props.threadId,
        comments: threadedComments,
        onCommentSubmit: this.handleCommentSubmit }),

      /*istanbul ignore next*/_react2.default.createElement( /*istanbul ignore next*/_CommentForm2.default, /*istanbul ignore next*/{ threadId: this.props.threadId,
        onCommentSubmit: this.handleCommentSubmit })));


  } })); /* istanbul ignore next */++__cov_HZEP$5Crg3GzsLhdG3_Cw5sCZF8.s['28'];


module.exports = CommentBox;